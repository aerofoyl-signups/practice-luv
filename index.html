<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Algebra Quiz: Functions, Domain, and Range</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- MathJax Configuration -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <!-- MathJax CDN -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        body { font-family: "Inter", sans-serif; }

        .rationale {
            display: none;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            padding: 0.5rem;
            border-radius: 0.375rem;
        }
        .rationale-correct {
            background-color: #f0fdf4; /* green-50 */
            color: #14532d;           /* green-900 */
        }
        .rationale-incorrect {
            background-color: #fef2f2; /* red-50 */
            color: #7f1d1d;            /* red-900 */
        }
        .option-btn.selected-correct {
            background-color: #dcfce7; /* green-100 */
            border-color: #22c55e;     /* green-500 */
            color: #15803d;            /* green-700 */
            font-weight: 600;
        }
        .option-btn.selected-incorrect {
            background-color: #fee2e2; /* red-100 */
            border-color: #ef4444;     /* red-500 */
            color: #b91c1c;            /* red-700 */
            font-weight: 600;
        }
        .option-btn:disabled {
            opacity: 0.8;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="bg-white w-full max-w-2xl rounded-xl shadow-xl overflow-hidden">
        <header class="p-6 bg-gray-50 border-b border-gray-200">
            <h1 class="text-2xl font-bold text-center text-gray-800">
                Algebra: Functions, Domain, and Range
            </h1>
        </header>

        <!-- Quiz Container -->
        <div id="quiz-container" class="p-6 md:p-8">
            <!-- Question -->
            <div id="question-container" class="mb-6">
                <p class="text-lg font-semibold text-gray-900" id="question-text">Loading question...</p>
                <p class="text-sm text-gray-500 mt-2" id="question-hint">Loading hint...</p>
            </div>

            <!-- Options -->
            <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>

            <!-- Nav -->
            <div class="mt-8 text-right">
                <button id="next-btn" class="hidden bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                    Next &rarr;
                </button>
            </div>
        </div>

        <!-- Results -->
        <div id="result-container" class="hidden p-6 md:p-8 text-center">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Quiz Complete!</h2>
            <p class="text-xl text-gray-600 mb-8" id="score-text">Your score: 0 / 0</p>
            <button id="restart-btn" class="bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                Restart Quiz
            </button>
        </div>
    </div>

    <script>
        // --- QUIZ DATA (corrected) ---
        const quizData = [
            // Category 1: Evaluating Functions
            {
                question: "If $f(x) = 2x + 7$, what is the value of $f(-3)$?",
                hint: "Replace the variable $x$ in the expression $2x + 7$ with the value $-3$ and simplify.",
                options: [
                    { text: "1", isCorrect: true, rationale: "Substitute $x=-3$: $2(-3) + 7 = -6 + 7 = 1$." },
                    { text: "13", isCorrect: false, rationale: "Likely used $2(3) + 7$ instead of $2(-3) + 7$." },
                    { text: "-1", isCorrect: false, rationale: "Sign mix-up when adding $-6 + 7$." },
                    { text: "10", isCorrect: false, rationale: "Doesn’t follow from substituting $-3$." }
                ]
            },
            {
                question: "If $g(t) = t^2 - 4t + 1$, what is the value of $g(5)$?",
                hint: "Substitute $t=5$ into the function. Calculate $5^2$ first.",
                options: [
                    { text: "6", isCorrect: true, rationale: "$(5)^2 - 4(5) + 1 = 25 - 20 + 1 = 6$." },
                    { text: "4", isCorrect: false, rationale: "Forgot the $+1$." },
                    { text: "46", isCorrect: false, rationale: "Order-of-operations error." },
                    { text: "11", isCorrect: false, rationale: "Did $25 - 20 - 1$." }
                ]
            },
            {
                question: "If $f(x) = x - 5$, what is the value of $3f(7)$?",
                hint: "Find $f(7)$ first, then multiply by 3.",
                options: [
                    { text: "16", isCorrect: false, rationale: "Computed $3\\cdot 7 - 5$ instead of $3\\cdot f(7)$." },
                    { text: "2", isCorrect: false, rationale: "$f(7)=2$, but the question asks for $3f(7)$." },
                    { text: "6", isCorrect: true, rationale: "$f(7)=7-5=2$, then $3\\cdot 2=6$." },
                    { text: "-6", isCorrect: false, rationale: "Sign error in multiplication or subtraction." }
                ]
            },
            {
                question: "If $p(x) = -2x^2 + 1$, what is the value of $p(-1) + 5$?",
                hint: "Compute $p(-1)$ carefully: $(-1)^2=1$. Then add 5.",
                options: [
                    { text: "3", isCorrect: false, rationale: "Used $-2(-1) + 1$ as if $(-1)^2=-1$." },
                    { text: "4", isCorrect: true, rationale: "$p(-1)=-2(1)+1=-1$, then $-1+5=4$." },
                    { text: "8", isCorrect: false, rationale: "Sign error when evaluating $p(-1)$." },
                    { text: "-1", isCorrect: false, rationale: "That’s $p(-1)$ only; the problem asks for $p(-1)+5$." }
                ]
            },
            {
                question: "If $h(x) = 10$, what is the value of $h(2) + h(-2)$?",
                hint: "This is a constant function; the output is the same for any $x$.",
                options: [
                    { text: "0", isCorrect: false, rationale: "Opposites don’t apply to constant functions." },
                    { text: "10", isCorrect: false, rationale: "That’s a single evaluation; you need the sum of two." },
                    { text: "20", isCorrect: true, rationale: "$h(2)=10$ and $h(-2)=10$, so $10+10=20$." },
                    { text: "14", isCorrect: false, rationale: "Doesn’t follow from a constant output of 10." }
                ]
            },
            {
                question: "If $k(x) = |x - 8| + 3$, what is the value of $k(2)$?",
                hint: "Compute $|2-8|$ first, then add 3.",
                options: [
                    { text: "9", isCorrect: true, rationale: "$|2-8|+3=|-6|+3=6+3=9$." },
                    { text: "-3", isCorrect: false, rationale: "Ignored absolute value: $-6+3$." },
                    { text: "13", isCorrect: false, rationale: "Miscomputed $|2-8|$ as 10." },
                    { text: "6", isCorrect: false, rationale: "That’s $|2-8|$; don’t forget the $+3$." }
                ]
            },
            {
                question: "If $f(x) = \\frac{x+3}{x-1}$, what is the value of $f(5)$?",
                hint: "Substitute into numerator and denominator, then simplify.",
                options: [
                    { text: "2", isCorrect: true, rationale: "$\\tfrac{5+3}{5-1}=\\tfrac{8}{4}=2$." },
                    { text: "8", isCorrect: false, rationale: "That’s the numerator only." },
                    { text: "4", isCorrect: false, rationale: "That’s the denominator only." },
                    { text: "1.5", isCorrect: false, rationale: "Arithmetic slip (e.g., $\\tfrac{6}{4}$)." }
                ]
            },
            {
                question: "If $g(x) = 2x^3 - x$, what is the value of $g(-2)$?",
                hint: "Careful with signs: $(-2)^3=-8$.",
                options: [
                    { text: "-14", isCorrect: true, rationale: "$2(-8) - (-2) = -16 + 2 = -14$." },
                    { text: "-18", isCorrect: false, rationale: "Did $2(-8) - 2$ instead of $-(-2)$." },
                    { text: "14", isCorrect: false, rationale: "Likely used $(-2)^3=8$ or flipped a sign." },
                    { text: "18", isCorrect: false, rationale: "Used $(-2)^3=8$ and added signs incorrectly." }
                ]
            },
            {
                question: "If $f(x) = 2x$ and $g(x) = x + 1$, what is the value of $f(g(3))$?",
                hint: "Composite function: find $g(3)$, then plug into $f$.",
                options: [
                    { text: "8", isCorrect: true, rationale: "$g(3)=4$, so $f(4)=8$." },
                    { text: "7", isCorrect: false, rationale: "Computed $f(3)+1$." },
                    { text: "6", isCorrect: false, rationale: "That’s $f(3)$; you need $f(g(3))$." },
                    { text: "4", isCorrect: false, rationale: "That’s $g(3)$; still need $f(\\cdot)$." }
                ]
            },
            {
                question: "If $f(x) = x^2 + 1$, what is the value of $f(f(0))$?",
                hint: "Work inside-out: find $f(0)$, then apply $f$ again.",
                options: [
                    { text: "2", isCorrect: true, rationale: "$f(0)=1$, then $f(1)=2$." },
                    { text: "1", isCorrect: false, rationale: "That’s $f(0)$; apply $f$ again." },
                    { text: "5", isCorrect: false, rationale: "That’s $f(2)$, not $f(f(0))$." },
                    { text: "0", isCorrect: false, rationale: "Initial input, not the final output." }
                ]
            },

            // Category 2: Domain & Range
            {
                question: "Consider the relation $\\{ (4, 7), (8, 9), (4, 3) \\}$. What is the domain?",
                hint: "Domain = set of all first coordinates (unique).",
                options: [
                    { text: "$\\{7, 9, 3\\}$", isCorrect: false, rationale: "Those are second coordinates (the range)." },
                    { text: "$\\{4, 8\\}$", isCorrect: true, rationale: "First coordinates are 4, 8, 4; unique set is $\\{4,8\\}$." },
                    { text: "$\\{4, 8, 4\\}$", isCorrect: false, rationale: "Sets list each element once." },
                    { text: "$\\{4, 7, 8, 9, 3\\}$", isCorrect: false, rationale: "Mixed x- and y-values." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 5), (2, 5), (3, 5) \\}$. What is the range?",
                hint: "Range = set of all second coordinates (unique).",
                options: [
                    { text: "$\\{1, 2, 3\\}$", isCorrect: false, rationale: "Those are first coordinates (the domain)." },
                    { text: "$\\{1, 2, 3, 5\\}$", isCorrect: false, rationale: "Mixed x- and y-values." },
                    { text: "$\\{5, 5, 5\\}$", isCorrect: false, rationale: "Sets don’t repeat identical elements." },
                    { text: "$\\{5\\}$", isCorrect: true, rationale: "Only y-value present is 5." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 2), (3, 4), (5, 6) \\}$. What is the domain?",
                hint: "Domain = first coordinates (unique).",
                options: [
                    { text: "$\\{1, 3, 5\\}$", isCorrect: true, rationale: "First coordinates are 1, 3, 5." },
                    { text: "$\\{2, 4, 6\\}$", isCorrect: false, rationale: "Those are second coordinates (the range)." },
                    { text: "$\\{1, 2, 3, 4, 5, 6\\}$", isCorrect: false, rationale: "Mixed x- and y-values." },
                    { text: "$\\{1, 2\\}$", isCorrect: false, rationale: "Only comes from the first pair." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 2), (3, 4), (5, 6) \\}$. What is the range?",
                hint: "Range = second coordinates (unique).",
                options: [
                    { text: "$\\{1, 3, 5\\}$", isCorrect: false, rationale: "Those are first coordinates (the domain)." },
                    { text: "$\\{2, 4, 6\\}$", isCorrect: true, rationale: "Second coordinates are 2, 4, 6." },
                    { text: "$\\{1, 2, 3, 4, 5, 6\\}$", isCorrect: false, rationale: "Mixed x- and y-values." },
                    { text: "$\\{5, 6\\}$", isCorrect: false, rationale: "Incomplete set of y-values." }
                ]
            },
            {
                question: "Consider the relation $\\{ (\\text{a}, 1), (\\text{b}, 2), (\\text{c}, 3) \\}$. What is the domain?",
                hint: "Domain = first elements of the pairs (here, letters).",
                options: [
                    { text: "$\\{\\text{a}, \\text{b}, \\text{c}\\}$", isCorrect: true, rationale: "All unique inputs." },
                    { text: "$\\{1, 2, 3\\}$", isCorrect: false, rationale: "Those are outputs (the range)." },
                    { text: "$\\{\\text{a}, 1, \\text{b}, 2, \\text{c}, 3\\}$", isCorrect: false, rationale: "Mixed inputs and outputs." },
                    { text: "$\\{3\\}$", isCorrect: false, rationale: "Single output, not the domain." }
                ]
            },
            {
                question: "Consider the relation $\\{ (\\text{a}, 1), (\\text{b}, 2), (\\text{c}, 1) \\}$. What is the range?",
                hint: "Range = set of second elements (unique).",
                options: [
                    { text: "$\\{\\text{a}, \\text{b}, \\text{c}\\}$", isCorrect: false, rationale: "Those are inputs (domain)." },
                    { text: "$\\{1, 2\\}$", isCorrect: true, rationale: "Outputs are 1, 2, 1; unique set is $\\{1,2\\}$." },
                    { text: "$\\{1, 2, 1\\}$", isCorrect: false, rationale: "Sets don’t repeat identical elements." },
                    { text: "$\\{1\\}$", isCorrect: false, rationale: "Incomplete; 2 is also present." }
                ]
            },
            {
                question: "Consider the relation $\\{ (5, 0), (0, 5), (-5, 0) \\}$. What is the domain?",
                hint: "Domain = first coordinates (unique).",
                options: [
                    { text: "$\\{5, 0, -5\\}$", isCorrect: true, rationale: "Unique first coordinates." },
                    { text: "$\\{0, 5\\}$", isCorrect: false, rationale: "Those are y-values (range)." },
                    { text: "$\\{5, 0\\}$", isCorrect: false, rationale: "Missing $-5$." },
                    { text: "$\\{5, 0, 0, 5, -5, 0\\}$", isCorrect: false, rationale: "Sets don’t repeat identical elements." }
                ]
            },
            {
                question: "Consider the relation $\\{ (5, 0), (0, 5), (-5, 0) \\}$. What is the range?",
                hint: "Range = second coordinates (unique).",
                options: [
                    { text: "$\\{5, 0, -5\\}$", isCorrect: false, rationale: "Those are x-values (domain)." },
                    { text: "$\\{0, 5\\}$", isCorrect: true, rationale: "Unique second coordinates are 0 and 5." },
                    { text: "$\\{0, 5, 0\\}$", isCorrect: false, rationale: "Sets don’t repeat identical elements." },
                    { text: "$\\{5\\}$", isCorrect: false, rationale: "Incomplete; 0 is also present." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 1), (2, 2), (3, 3) \\}$. What is the domain?",
                hint: "Domain = set of all first coordinates (unique).",
                options: [
                    { text: "$\\{1, 2, 3\\}$", isCorrect: true, rationale: "First coordinates are 1, 2, 3." },
                    { text: "$\\{1, 1, 2, 2, 3, 3\\}$", isCorrect: false, rationale: "Sets list unique elements only." },
                    { text: "$\\{1\\}$", isCorrect: false, rationale: "Incomplete; missing 2 and 3." },
                    { text: "$\\{ (1,1), (2,2), (3,3) \\}$", isCorrect: false, rationale: "That’s the relation, not the domain." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 1), (2, 2), (3, 3) \\}$. What is the range?",
                hint: "Range = set of all second coordinates (unique).",
                options: [
                    { text: "$\\{1, 2, 3\\}$", isCorrect: true, rationale: "Second coordinates are 1, 2, 3." },
                    { text: "$\\{1, 1, 2, 2, 3, 3\\}$", isCorrect: false, rationale: "Sets list unique elements only." },
                    { text: "$\\{1, 2\\}$", isCorrect: false, rationale: "Incomplete; missing 3." },
                    { text: "$\\{ (1,1), (2,2), (3,3) \\}$", isCorrect: false, rationale: "That’s the relation, not the range." }
                ]
            },

            // Category 3: Identifying Functions
            {
                question: "Is the relation $\\{ (1, 2), (3, 4), (5, 6), (7, 8) \\}$ a function?",
                hint: "Every input (x) must have exactly one output (y).",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "Each x-value is unique and has one y-value." },
                    { text: "No", isCorrect: false, rationale: "No x-values repeat with different outputs." }
                ]
            },
            {
                question: "Is the relation $\\{ (10, \\text{a}), (20, \\text{b}), (30, \\text{a}), (40, \\text{c}) \\}$ a function?",
                hint: "It’s okay if outputs repeat; x-values must not split to multiple y-values.",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "All x-values (10,20,30,40) are unique." },
                    { text: "No", isCorrect: false, rationale: "Repeating outputs are allowed; inputs are unique." }
                ]
            },
            {
                question: "Is the relation $\\{ (-1, \\text{a}), (0, \\text{b}), (-1, \\text{c}) \\}$ a function?",
                hint: "Check if any x-value maps to more than one y-value.",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "$x=-1$ maps to both $\\text{a}$ and $\\text{c}$." },
                    { text: "No", isCorrect: true, rationale: "One input has two outputs, so it’s not a function." }
                ]
            },
            {
                question: "Is the relation $\\{ (1, 5), (2, 5), (3, 5) \\}$ a function?",
                hint: "Are any x-values repeated?",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "Each input is unique with exactly one output." },
                    { text: "No", isCorrect: false, rationale: "Same output for different inputs is allowed." }
                ]
            },
            {
                question: "Is the relation $\\{ (5, 1), (5, 2), (5, 3) \\}$ a function?",
                hint: "Does one x-value map to multiple y-values?",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "$x=5$ maps to 1, 2, and 3." },
                    { text: "No", isCorrect: true, rationale: "One input to multiple outputs is not a function." }
                ]
            },
            {
                question: "Is the relation $\\{ (\\text{a}, 1), (\\text{b}, 1), (\\text{c}, 1) \\}$ a function?",
                hint: "Are any of the inputs repeated?",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "All inputs are unique and each maps to one output." },
                    { text: "No", isCorrect: false, rationale: "Repeating outputs is allowed; inputs are unique." }
                ]
            },
            {
                question: "Is the relation $\\{ (1, \\text{a}), (1, \\text{b}), (2, \\text{c}) \\}$ a function?",
                hint: "Focus on $x=1$; how many outputs?",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "$x=1$ has two outputs ($\\text{a}$ and $\\text{b}$)." },
                    { text: "No", isCorrect: true, rationale: "One input to multiple outputs is not a function." }
                ]
            },
            {
                question: "Is the relation $\\{ (9, 3), (9, -3), (4, 2) \\}$ a function?",
                hint: "Focus on $x=9$.",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "$x=9$ has outputs 3 and -3." },
                    { text: "No", isCorrect: true, rationale: "One input to multiple outputs is not a function." }
                ]
            },
            {
                question: "Is the relation $\\{ (1, \\text{z}), (2, \\text{y}), (3, \\text{x}) \\}$ a function?",
                hint: "Are any x-values repeated?",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "Each input (1,2,3) has exactly one output." },
                    { text: "No", isCorrect: false, rationale: "All inputs are unique with one output each." }
                ]
            },
            {
                question: "Is the relation $\\{ (\\text{apple}, 1), (\\text{banana}, 2), (\\text{apple}, 3) \\}$ a function?",
                hint: "Does one input map to more than one output?",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "$\\text{apple}$ maps to 1 and 3." },
                    { text: "No", isCorrect: true, rationale: "One input to multiple outputs is not a function." }
                ]
            }
        ];


    // --- De-duplicate questions by their question text (trimmed) ---
    function dedupeQuestions(data) {
        const seen = new Set();
        const unique = [];
        for (const q of data) {
            const key = q.question.replace(/\s+/g, ' ').trim();
            if (!seen.has(key)) {
                seen.add(key);
                unique.push(q);
            }
        }
        return unique;
    }

    // --- DOM Elements ---
    const quizContainer = document.getElementById('quiz-container');
    const resultContainer = document.getElementById('result-container');
    const questionText = document.getElementById('question-text');
    const questionHint = document.getElementById('question-hint');
    const optionsContainer = document.getElementById('options-container');
    const nextBtn = document.getElementById('next-btn');
    const scoreText = document.getElementById('score-text');
    const restartBtn = document.getElementById('restart-btn');

    // --- Quiz State ---
    let currentQuestionIndex = 0;
    let score = 0;
    let activeQuizData = [];

    // --- Helpers ---
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function startQuiz() {
        currentQuestionIndex = 0;
        score = 0;

        // 1) De-duplicate by question text
        const unique = dedupeQuestions(quizData);

        // 2) Shuffle a fresh copy
        activeQuizData = [...unique];
        shuffleArray(activeQuizData);

        resultContainer.classList.add('hidden');
        quizContainer.classList.remove('hidden');
        nextBtn.classList.add('hidden');
        showQuestion();
    }

    function showQuestion() {
        resetState();
        const question = activeQuizData[currentQuestionIndex];

        questionText.innerHTML = question.question;
        questionHint.innerHTML = question.hint;

        const shuffledOptions = [...question.options];
        shuffleArray(shuffledOptions);

        shuffledOptions.forEach(option => {
            const button = document.createElement('button');
            button.dataset.originalText = option.text;
            button.dataset.correct = option.isCorrect ? "true" : "false"; // robustness

            const textSpan = document.createElement('span');
            textSpan.innerHTML = option.text;
            button.appendChild(textSpan);

            button.classList.add(
                'option-btn',
                'w-full',
                'p-4',
                'border-2',
                'border-gray-300',
                'rounded-lg',
                'text-left',
                'hover:bg-gray-100',
                'hover:border-blue-400',
                'transition-colors',
                'duration-200'
            );

            const rationaleDiv = document.createElement('div');
            rationaleDiv.textContent = option.rationale;
            rationaleDiv.classList.add('rationale');
            rationaleDiv.classList.add(option.isCorrect ? 'rationale-correct' : 'rationale-incorrect');
            button.appendChild(rationaleDiv);

            button.addEventListener('click', () => selectAnswer(button, option.isCorrect));
            optionsContainer.appendChild(button);
        });

        if (window.MathJax) {
            MathJax.typesetPromise([quizContainer]).catch(err => console.log('MathJax typesetting error:', err));
        }
    }

    function resetState() {
        nextBtn.classList.add('hidden');
        while (optionsContainer.firstChild) {
            optionsContainer.removeChild(optionsContainer.firstChild);
        }
    }

    function selectAnswer(selectedButton, isCorrect) {
        if (isCorrect) {
            score++;
            selectedButton.classList.add('selected-correct');
        } else {
            selectedButton.classList.add('selected-incorrect');
        }

        Array.from(optionsContainer.children).forEach(button => {
            button.disabled = true;
            const rationale = button.querySelector('.rationale');
            rationale.style.display = 'block';

            // Highlight the correct option if user chose wrong
            if (!isCorrect && button.dataset.correct === "true") {
                button.classList.add('selected-correct');
            }
        });

        nextBtn.classList.remove('hidden');
    }

    function showResults() {
        quizContainer.classList.add('hidden');
        resultContainer.classList.remove('hidden');
        scoreText.textContent = `Your score: ${score} / ${activeQuizData.length}`;
        if (window.MathJax) {
            MathJax.typesetPromise([resultContainer]).catch(err => console.log('MathJax typesetting error:', err));
        }
    }

    function handleNextButton() {
        currentQuestionIndex++;
        if (currentQuestionIndex < activeQuizData.length) {
            showQuestion();
        } else {
            showResults();
        }
    }

    nextBtn.addEventListener('click', handleNextButton);
    restartBtn.addEventListener('click', startQuiz);
    document.addEventListener('DOMContentLoaded', startQuiz);
</script>

</body>
</html>
