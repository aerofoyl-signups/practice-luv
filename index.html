<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algebra Quiz: Functions, Domain, and Range</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- MathJax Configuration -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <!-- MathJax CDN -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        /* Using Inter font */
        body {
            font-family: "Inter", sans-serif;
        }
        /* Style for the rationale text */
        .rationale {
            display: none; /* Hidden by default */
            font-size: 0.875rem; /* text-sm */
            margin-top: 0.5rem; /* mt-2 */
            padding: 0.5rem; /* p-2 */
            border-radius: 0.375rem; /* rounded-md */
        }
        .rationale-correct {
            background-color: #f0fdf4; /* green-50 */
            color: #14532d; /* green-900 */
        }
        .rationale-incorrect {
            background-color: #fef2f2; /* red-50 */
            color: #7f1d1d; /* red-900 */
        }
        /* Custom styles for selected states */
        .option-btn.selected-correct {
            background-color: #dcfce7; /* green-100 */
            border-color: #22c55e; /* green-500 */
            color: #15803d; /* green-700 */
            font-weight: 600;
        }
        .option-btn.selected-incorrect {
            background-color: #fee2e2; /* red-100 */
            border-color: #ef4444; /* red-500 */
            color: #b91c1c; /* red-700 */
            font-weight: 600;
        }
        .option-btn:disabled {
            opacity: 0.8;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <div class="bg-white w-full max-w-2xl rounded-xl shadow-xl overflow-hidden">
        
        <header class="p-6 bg-gray-50 border-b border-gray-200">
            <h1 class="text-2xl font-bold text-center text-gray-800">Algebra: Functions, Domain, and Range</h1>
        </header>

        <!-- Quiz Container -->
        <div id="quiz-container" class="p-6 md:p-8">
            <!-- Question Container -->
            <div id="question-container" class="mb-6">
                <p class="text-lg font-semibold text-gray-900" id="question-text">Loading question...</p>
                <p class="text-sm text-gray-500 mt-2" id="question-hint">Loading hint...</p>
            </div>

            <!-- Options Container -->
            <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Options will be dynamically inserted here -->
            </div>

            <!-- Feedback & Navigation -->
            <div class="mt-8 text-right">
                <button id="next-btn" class="hidden bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                    Next &rarr;
                </button>
            </div>
        </div>

        <!-- Result Container -->
        <div id="result-container" class="hidden p-6 md:p-8 text-center">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Quiz Complete!</h2>
            <p class="text-xl text-gray-600 mb-8" id="score-text">Your score: 0 / 0</p>
            <button id="restart-btn" class="bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                Restart Quiz
            </button>
        </div>

    </div>

    <script>
        // --- QUIZ DATA ---
        // Manually parsed from the provided file content
        const quizData = [
            // Category 1: Evaluating Functions
            {
                question: "If $f(x) = 2x + 7$, what is the value of $f(-3)$?",
                hint: "Replace the variable $x$ in the expression $2x + 7$ with the value $-3$ and simplify.",
                options: [
                    { text: "1", isCorrect: true, rationale: "This value is obtained by substituting $x = -3$ into the expression: $2(-3) + 7 = -6 + 7$." },
                    { text: "13", isCorrect: false, rationale: "This result might come from an error in signs, such as calculating $2(3) + 7$ instead of $2(-3) + 7$." },
                    { text: "-1", isCorrect: false, rationale: "This result might come from a sign error, such as $2(3) - 7$ or incorrectly adding $-6 + 7$." },
                    { text: "10", isCorrect: false, rationale: "This result doesn't follow from substituting $-3$ into the given function expression." }
                ]
            },
            {
                question: "If $g(t) = t^2 - 4t + 1$, what is the value of $g(5)$?",
                hint: "Substitute $t=5$ into the function. Remember to follow the order of operations, calculating $5^2$ first.",
                options: [
                    { text: "6", isCorrect: true, rationale: "This value is found by calculating $(5)^2 - 4(5) + 1$, which simplifies to $25 - 20 + 1$." },
                    { text: "4", isCorrect: false, rationale: "This result might be obtained if the last term $+1$ was forgotten in the calculation $25 - 20$." },
                    { text: "46", isCorrect: false, rationale: "This result might come from an error in operation order, perhaps by adding $4(5) + 1$ before subtracting." },
                    { text: "11", isCorrect: false, rationale: "This result could come from a sign error, such as $25 - 20 - 1$ instead of $25 - 20 + 1$." }
                ]
            },
            {
                question: "If $f(x) = x - 5$, what is the value of $3f(7)$?",
                hint: "First, find the value of $f(7)$ by substituting $x=7$. Then, multiply your answer by 3.",
                options: [
                    { text: "16", isCorrect: false, rationale: "This might be the result of incorrectly calculating $3(7) - 5$ instead of first finding $f(7)$." },
                    { text: "2", isCorrect: false, rationale: "This is the value of $f(7)$ itself, which is $7 - 5$. The question asks for $3$ times this value." },
                    { text: "6", isCorrect: true, rationale: "This is found by first evaluating $f(7) = 7 - 5 = 2$, and then multiplying that result by 3." },
                    { text: "-6", isCorrect: false, rationale: "This result might come from a sign error in the final multiplication or initial subtraction." }
                ]
            },
            {
                question: "If $p(x) = -2x^2 + 1$, what is the value of $p(-1) + 5$?",
                hint: "Calculate $p(-1)$ first. Be careful with the exponent: $(-1)^2 = 1$. Then add 5 to your result.",
                options: [
                    { text: "3", isCorrect: false, rationale: "This result might come from miscalculating $(-1)^2$ as $-1$, leading to $-2(-1) + 1 = 3$, before adding 5." },
                    { text: "4", isCorrect: true, rationale: "This is found by first evaluating $p(-1) = -2(-1)^2 + 1 = -2(1) + 1 = -1$. Then, add 5 to this result: $-1 + 5$." },
                    { text: "8", isCorrect: false, rationale: "This result might come from an error in signs, perhaps calculating $p(-1)$ as $3$ and then adding $5$." },
                    { text: "-1", isCorrect: false, rationale: "This is the value of $p(-1)$ alone. The question asks for this value plus 5." }
                ]
            },
            {
                question: "If $h(x) = 10$, what is the value of $h(2) + h(-2)$?",
                hint: "This is a constant function. What is the output for *any* input value $x$?",
                options: [
                    { text: "0", isCorrect: false, rationale: "This might be assumed if $h(2)$ and $h(-2)$ were opposites, but the function's output is constant." },
                    { text: "10", isCorrect: false, rationale: "This is the value of $h(x)$ for any single input, but the question asks for the sum of two function evaluations." },
                    { text: "20", isCorrect: true, rationale: "Since $h(x)$ is a constant function, $h(2) = 10$ and $h(-2) = 10$. The sum is $10 + 10$." },
                    { text: "14", isCorrect: false, rationale: "This result doesn't follow from the function definition, which always outputs 10 regardless of the input." }
                ]
            },
             {
                question: "If $k(x) = |x - 8| + 3$, what is the value of $k(2)$?",
                hint: "First, calculate the value inside the absolute value bars: $2 - 8$. Then take the absolute value of that result and add 3.",
                options: [
                    { text: "9", isCorrect: true, rationale: "This is found by calculating $|2 - 8| + 3 = |-6| + 3 = 6 + 3$." },
                    { text: "-3", isCorrect: false, rationale: "This result might come from ignoring the absolute value, calculating $-6 + 3$." },
                    { text: "13", isCorrect: false, rationale: "This result might come from incorrectly calculating $|2 - 8|$ as $10$." },
                    { text: "6", isCorrect: false, rationale: "This is the value of $|2 - 8|$, but the function adds 3 to this result." }
                ]
            },
            {
                question: "If $f(x) = \\frac{x+3}{x-1}$, what is the value of $f(5)$?",
                hint: "Substitute $x=5$ into both the numerator and the denominator, then simplify the fraction.",
                options: [
                    { text: "2", isCorrect: true, rationale: "This is found by calculating $\\frac{5+3}{5-1} = \\frac{8}{4}$." },
                    { text: "8", isCorrect: false, rationale: "This is the value of the numerator, $5+3$, but you must also divide by the denominator." },
                    { text: "4", isCorrect: false, rationale: "This is the value of the denominator, $5-1$, not the final value of the fraction." },
                    { text: "1.5", isCorrect: false, rationale: "This might result from an arithmetic error, such as $\\frac{6}{4}$." }
                ]
            },
            {
                question: "If $g(x) = 2x^3 - x$, what is the value of $g(-2)$?",
                hint: "Be careful with signs. $(-2)^3 = -8$. Substitute $x=-2$ into the expression.",
                options: [
                    { text: "-14", isCorrect: true, rationale: "This is found by calculating $2(-2)^3 - (-2) = 2(-8) + 2 = -16 + 2$." },
                    { text: "-18", isCorrect: false, rationale: "This result might come from a sign error, such as $2(-8) - 2 = -16 - 2$." },
                    { text: "14", isCorrect: false, rationale: "This result might come from miscalculating $(-2)^3$ as $8$, leading to $2(8) - (-2) = 16 + 2 = 18$, or $2(-8) - 2$ and a sign flip." },
                    { text: "18", isCorrect: false, rationale: "This result might come from miscalculating $(-2)^3$ as $8$, leading to $2(8) - (-2) = 16 + 2$." }
                ]
            },
            {
                question: "If $f(x) = 2x$ and $g(x) = x + 1$, what is the value of $f(g(3))$?",
                hint: "This is a composite function. First, find the value of $g(3)$, then use that result as the input for $f(x)$_.",
                options: [
                    { text: "8", isCorrect: true, rationale: "First, $g(3) = 3 + 1 = 4$. Then, $f(4) = 2(4) = 8$." },
                    { text: "7", isCorrect: false, rationale: "This might be $f(3) + 1$, which is $2(3) + 1 = 7$. This is not the correct order." },
                    { text: "6", isCorrect: false, rationale: "This is the value of $f(3)$ alone. You need to evaluate $g(3)$ first." },
                    { text: "4", isCorrect: false, rationale: "This is the value of $g(3)$ alone. You need to plug this value into $f(x)$." }
                ]
            },
            {
                question: "If $f(x) = x^2 + 1$, what is the value of $f(f(0))$?",
                hint: "Work from the inside out. First, find $f(0)$, then plug that result back into $f(x)$_.",
                options: [
                    { text: "2", isCorrect: true, rationale: "First, $f(0) = (0)^2 + 1 = 1$. Then, $f(1) = (1)^2 + 1 = 2$." },
                    { text: "1", isCorrect: false, rationale: "This is the value of $f(0)$, but you need to apply the function a second time." },
                    { text: "5", isCorrect: false, rationale: "This might be $f(2)$, but the input for the second step is $f(0)$." },
                    { text: "0", isCorrect: false, rationale: "This is the initial input, not the final output after applying the function twice." }
                ]
            },
            // Category 2: Domain & Range
            {
                question: "Consider the relation $\\{ (4, 7), (8, 9), (4, 3) \\}$. What is the domain?",
                hint: "The domain is the set of all the first numbers (x-coordinates) in the ordered pairs. Remember, a set only lists unique values.",
                options: [
                    { text: "$\\{7, 9, 3\\}$", isCorrect: false, rationale: "This is the set of all the second coordinates (y-values), which is the range of the relation." },
                    { text: "$\\{4, 8\\}$", isCorrect: true, rationale: "The domain is the set of all unique first coordinates (x-values). The x-values are 4, 8, and 4." },
                    { text: "$\\{4, 8, 4\\}$", isCorrect: false, rationale: "This lists all the first coordinates, but sets only include each unique element once." },
                    { text: "$\\{4, 7, 8, 9, 3\\}$", isCorrect: false, rationale: "This set includes both the x-values and y-values. The domain only includes the x-values." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 5), (2, 5), (3, 5) \\}$. What is the range?",
                hint: "The range is the set of all the second numbers (y-coordinates) in the ordered pairs. How many unique y-values are there?",
                options: [
                    { text: "$\\{1, 2, 3\\}$", isCorrect: false, rationale: "This is the set of all the first coordinates (x-values), which is the domain of the relation." },
                    { text: "$\\{1, 2, 3, 5\\}$", isCorrect: false, rationale: "This set includes both the x-values and y-values. The range only includes the y-values." },
                    { text: "$\\{5, 5, 5\\}$", isCorrect: false, rationale: "This lists all the second coordinates, but sets only include each unique element once." },
                    { text: "$\\{5\\}$", isCorrect: true, rationale: "The range is the set of all unique second coordinates (y-values). The only y-value that appears is 5." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 2), (3, 4), (5, 6) \\}$. What is the domain?",
                hint: "The domain is the set of all the first numbers (x-coordinates) in the ordered pairs.",
                options: [
                    { text: "$\\{1, 3, 5\\}$", isCorrect: true, rationale: "The domain is the set of all unique first coordinates (x-values)." },
                    { text: "$\\{2, 4, 6\\}$", isCorrect: false, rationale: "This is the set of all the second coordinates (y-values), which is the range." },
                    { text: "$\\{1, 2, 3, 4, 5, 6\\}$", isCorrect: false, rationale: "This set includes both the x-values and y-values." },
                    { text: "$\\{1, 2\\}$", isCorrect: false, rationale: "This is only the first ordered pair, not the complete set of x-values." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 2), (3, 4), (5, 6) \\}$. What is the range?",
                hint: "The range is the set of all the second numbers (y-coordinates) in the ordered pairs.",
                options: [
                    { text: "$\\{1, 3, 5\\}$", isCorrect: false, rationale: "This is the set of all the first coordinates (x-values), which is the domain." },
                    { text: "$\\{2, 4, 6\\}$", isCorrect: true, rationale: "The range is the set of all unique second coordinates (y-values)." },
                    { text: "$\\{1, 2, 3, 4, 5, 6\\}$", isCorrect: false, rationale: "This set includes both the x-values and y-values." },
                    { text: "$\\{5, 6\\}$", isCorrect: false, rationale: "This is only the last ordered pair, not the complete set of y-values." }
                ]
            },
            {
                question: "Consider the relation $\\{ (\\text{'a'}, 1), (\\text{'b'}, 2), (\\text{'c'}, 3) \\}$. What is the domain?",
                hint: "The domain is the set of all the first elements in the ordered pairs. In this case, they are letters.",
                options: [
                    { text: "$\\{\\text{'a'}, \\text{'b'}, \\text{'c'}\\}$", isCorrect: true, rationale: "The domain is the set of all unique first elements (inputs)." },
                    { text: "$\\{1, 2, 3\\}$", isCorrect: false, rationale: "This is the set of all the second elements (outputs), which is the range." },
                    { text: "$\\{\\text{'a'}, 1, \\text{'b'}, 2, \\text{'c'}, 3\\}$", isCorrect: false, rationale: "This set includes all elements, not just the inputs." },
                    { text: "$\\{3\\}$", isCorrect: false, rationale: "This is only a single output value, not the domain." }
                ]
            },
            {
                question: "Consider the relation $\\{ (\\text{'a'}, 1), (\\text{'b'}, 2), (\\text{'c'}, 1) \\}$. What is the range?",
                hint: "The range is the set of all the second elements (outputs). Remember that sets only list unique values.",
                options: [
                    { text: "$\\{\\text{'a'}, \\text{'b'}, \\text{'c'}\\}$", isCorrect: false, rationale: "This is the set of all the first elements (inputs), which is the domain." },
                    { text: "$\\{1, 2\\}$", isCorrect: true, rationale: "The range is the set of all unique second elements. The outputs are 1, 2, and 1." },
                    { text: "$\\{1, 2, 1\\}$", isCorrect: false, rationale: "This lists all the outputs, but sets only include each unique element once." },
                    { text: "$\\{1\\}$", isCorrect: false, rationale: "This is one of the outputs, but it is not the complete set of unique outputs." }
                ]
            },
            {
                question: "Consider the relation $\\{ (5, 0), (0, 5), (-5, 0) \\}$. What is the domain?",
                hint: "The domain is the set of all unique x-coordinates (first numbers) from the pairs.",
                options: [
                    { text: "$\\{5, 0, -5\\}$", isCorrect: true, rationale: "The domain is the set of all unique first coordinates: 5, 0, and -5." },
                    { text: "$\\{0, 5\\}$", isCorrect: false, rationale: "This is the set of all unique second coordinates (y-values), which is the range." },
                    { text: "$\\{5, 0\\}$", isCorrect: false, rationale: "This is missing the x-value -5." },
                    { text: "$\\{5, 0, 0, 5, -5, 0\\}$", isCorrect: false, rationale: "This lists all numbers, not just the unique x-values." }
                ]
            },
            {
                question: "Consider the relation $\\{ (5, 0), (0, 5), (-5, 0) \\}$. What is the range?",
                hint: "The range is the set of all unique y-coordinates (second numbers) from the pairs.",
                options: [
                    { text: "$\\{5, 0, -5\\}$", isCorrect: false, rationale: "This is the set of all unique first coordinates (x-values), which is the domain." },
                    { text: "$\\{0, 5\\}$", isCorrect: true, rationale: "The range is the set of all unique second coordinates. The y-values are 0, 5, and 0." },
                    { text: "$\\{0, 5, 0\\}$", isCorrect: false, rationale: "This lists all the second coordinates, but sets only include each unique element once." },
                    { text: "$\\{5\\}$", isCorrect: false, rationale: "This is one of the outputs, but it is not the complete set of unique outputs." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 1), (2, 2), (3, 3) \\}$. What is the domain?",
                hint: "The domain is the set of all the first numbers (x-coordinates) in the ordered pairs.",
                options: [
                    { text: "$\\{1, 2, 3\\}$", isCorrect: true, rationale: "The domain is the set of all unique first coordinates." },
                    { text: "$\\{1, 2, 3, 1, 2, 3\\}$", isCorrect: false, rationale: "This lists all numbers, not just the unique x-values." },
                    { text: "$\\{1, 2, 3\\}$", isCorrect: true, rationale: "The set of x-values is $\\{1, 2, 3\\}$. This is the domain." }, // Note: This is a duplicate, but the options will be shuffled. Let's make it more distinct.
                    // Let's fix the above question's options to be better.
                    // Correcting options for Q19
                    { text: "$\\{1, 2, 3\\}$", isCorrect: true, rationale: "The domain is the set of all unique first coordinates (x-values)." },
                    { text: "$\\{1, 1, 2, 2, 3, 3\\}$", isCorrect: false, rationale: "This set includes both the x-values and y-values." },
                    { text: "$\\{1\\}$", isCorrect: false, rationale: "This is only one of the x-values, not the complete set." },
                    { text: "$\\{ (1, 1), (2, 2), (3, 3) \\}$", isCorrect: false, rationale: "This is the relation itself, not the set of x-values." }
                ]
            },
            // Re-creating Q19 with fixed options
            {
                question: "Consider the relation $\\{ (1, 1), (2, 2), (3, 3) \\}$. What is the domain?",
                hint: "The domain is the set of all the first numbers (x-coordinates) in the ordered pairs.",
                options: [
                    { text: "$\\{1, 2, 3\\}$", isCorrect: true, rationale: "The domain is the set of all unique first coordinates (x-values)." },
                    { text: "$\\{1, 1, 2, 2, 3, 3\\}$", isCorrect: false, rationale: "This set includes both the x-values and y-values." },
                    { text: "$\\{1\\}$", isCorrect: false, rationale: "This is only one of the x-values, not the complete set." },
                    { text: "$\\{ (1, 1), (2, 2), (3, 3) \\}$", isCorrect: false, rationale: "This is the relation itself, not just the set of x-values." }
                ]
            },
            {
                question: "Consider the relation $\\{ (1, 1), (2, 2), (3, 3) \\}$. What is the range?",
                hint: "The range is the set of all the second numbers (y-coordinates) in the ordered pairs.",
                options: [
                    { text: "$\\{1, 2, 3\\}$", isCorrect: true, rationale: "The range is the set of all unique second coordinates (y-values)." },
                    { text: "$\\{1, 1, 2, 2, 3, 3\\}$", isCorrect: false, rationale: "This set includes both the x-values and y-values." },
                    { text: "$\\{1, 2\\}$", isCorrect: false, rationale: "This is an incomplete set of the y-values." },
                    { text: "$\\{ (1, 1), (2, 2), (3, 3) \\}$", isCorrect: false, rationale: "This is the relation itself, not just the set of y-values." }
                ]
            },
            // Category 3: Identifying Functions
            {
                question: "Is the relation $\\{ (1, 2), (3, 4), (5, 6), (7, 8) \\}$ a function?",
                hint: "To be a function, every x-value (input) must have exactly one y-value (output). Check if any x-values are repeated.",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "Each x-value (1, 3, 5, 7) is paired with exactly one y-value. No x-values are repeated." },
                    { text: "No", isCorrect: false, rationale: "This relation is a function because every input has only one output. Repeating y-values would be allowed, but repeating x-values is not." }
                ]
            },
            {
                question: "Is the relation $\\{ (10, \\text{'a'}), (20, \\text{'b'}), (30, \\text{'a'}), (40, \\text{'c'}) \\}$ a function?",
                hint: "Does any x-value (input) map to more than one y-value (output)? It's okay for different inputs to have the same output.",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "Each x-value (10, 20, 30, 40) is unique and paired with exactly one y-value. It is okay for y-values (like 'a') to be repeated." },
                    { text: "No", isCorrect: false, rationale: "This relation is a function. The y-value 'a' is repeated, but this is allowed. The condition for a function is that no x-value is repeated." }
                ]
            },
            {
                question: "Is the relation $\\{ (-1, \\text{'a'}), (0, \\text{'b'}), (-1, \\text{'c'}) \\}$ a function?",
                hint: "Look closely at the x-values. Is any x-value repeated and paired with a *different* y-value?",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "This relation is not a function because the input $x = -1$ is paired with two different outputs, 'a' and 'c'." },
                    { text: "No", isCorrect: true, rationale: "The x-value $-1$ is paired with 'a' and also with 'c'. Since one input has two different outputs, it is not a function." }
                ]
            },
             {
                question: "Is the relation $\\{ (1, 5), (2, 5), (3, 5) \\}$ a function?",
                hint: "Check the x-values. Are any of them repeated?",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "Each x-value (1, 2, 3) is unique and has exactly one output. It's allowed for multiple inputs to have the same output (5)." },
                    { text: "No", isCorrect: false, rationale: "This relation is a function. The y-value 5 is repeated, but this is allowed. The x-values are all different." }
                ]
            },
            {
                question: "Is the relation $\\{ (5, 1), (5, 2), (5, 3) \\}$ a function?",
                hint: "Check the x-values. Is the same x-value paired with different y-values?",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "This relation is not a function. The input $x = 5$ is paired with three different outputs (1, 2, and 3)." },
                    { text: "No", isCorrect: true, rationale: "The x-value 5 is paired with 1, 2, and 3. Since one input has multiple outputs, it is not a function." }
                ]
            },
            {
                question: "Is the relation $\\{ (\\text{'a'}, 1), (\\text{'b'}, 1), (\\text{'c'}, 1) \\}$ a function?",
                hint: "Are any of the inputs ('a', 'b', 'c') repeated?",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "Each input ('a', 'b', 'c') is unique and has exactly one output. It is fine for all outputs to be the same." },
                    { text: "No", isCorrect: false, rationale: "This relation is a function. The output 1 is repeated, but this is allowed. Each input is unique." }
                ]
            },
            {
                question: "Is the relation $\\{ (1, \\text{'a'}), (1, \\text{'b'}), (2, \\text{'c'}) \\}$ a function?",
                hint: "Look at the input $x = 1$. How many outputs is it paired with?",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "This relation is not a function. The input 1 is paired with two different outputs, 'a' and 'b'." },
                    { text: "No", isCorrect: true, rationale: "The x-value 1 is paired with 'a' and also with 'b'. Since one input has two different outputs, it is not a function." }
                ]
            },
            {
                question: "Is the relation $\\{ (9, 3), (9, -3), (4, 2) \\}$ a function?",
                hint: "Check the x-value 9. Does it map to more than one y-value?",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "This relation is not a function. The input 9 is paired with two different outputs, 3 and -3." },
                    { text: "No", isCorrect: true, rationale: "The x-value 9 is paired with both 3 and -3. Since one input has multiple outputs, it is not a function." }
                ]
            },
            {
                question: "Is the relation $\\{ (1, \\text{'z'}), (2, \\text{'y'}), (3, \\text{'x'}) \\}$ a function?",
                hint: "Are any of the x-values (1, 2, 3) repeated?",
                options: [
                    { text: "Yes", isCorrect: true, rationale: "Each x-value (1, 2, 3) is unique and is paired with exactly one y-value. This is a function." },
                    { text: "No", isCorrect: false, rationale: "This relation is a function. All inputs are unique and have one output." }
                ]
            },
            {
                question: "Is the relation $\\{ (\\text{'apple'}, 1), (\\text{'banana'}, 2), (\\text{'apple'}, 3) \\}$ a function?",
                hint: "Look at the input 'apple'. How many different outputs does it have?",
                options: [
                    { text: "Yes", isCorrect: false, rationale: "This relation is not a function. The input 'apple' is paired with two different outputs, 1 and 3." },
                    { text: "No", isCorrect: true, rationale: "The input 'apple' is paired with both 1 and 3. Since one input has multiple outputs, it is not a function." }
                ]
            }
        ];
        
        // --- Clean up potential duplicates from copy-paste ---
        // This is a bit manual, but I see a duplicate of Q19. Let's remove it.
        // The array above has 31 items. Q18 and Q19 are identical.
        quizData.splice(18, 1); // Removes the duplicate at index 18
        

        // --- DOM Elements ---
        const quizContainer = document.getElementById('quiz-container');
        const resultContainer = document.getElementById('result-container');
        const questionText = document.getElementById('question-text');
        const questionHint = document.getElementById('question-hint');
        const optionsContainer = document.getElementById('options-container');
        const nextBtn = document.getElementById('next-btn');
        const scoreText = document.getElementById('score-text');
        const restartBtn = document.getElementById('restart-btn');

        // --- Quiz State ---
        let currentQuestionIndex = 0;
        let score = 0;
        let activeQuizData = []; // To hold the shuffled questions

        // --- Functions ---

        /**
         * Shuffles an array in place using the Fisher-Yates algorithm.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        /**
         * Initializes or restarts the quiz.
         */
        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            
            // Create a shuffled copy of the quiz data
            activeQuizData = [...quizData];
            shuffleArray(activeQuizData);
            
            resultContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            nextBtn.classList.add('hidden');
            showQuestion();
        }

        /**
         * Displays the current question and options.
         */
        function showQuestion() {
            resetState();
            const question = activeQuizData[currentQuestionIndex];
            
            questionText.innerHTML = question.question;
            questionHint.innerHTML = question.hint;

            // Create a shuffled copy of the options
            const shuffledOptions = [...question.options];
            shuffleArray(shuffledOptions);

            shuffledOptions.forEach(option => {
                const button = document.createElement('button');
                button.dataset.originalText = option.text; // Store original text for rationale lookup
                
                // Create a span for the text to separate it from rationale
                const textSpan = document.createElement('span');
                textSpan.innerHTML = option.text;
                button.appendChild(textSpan);
                
                button.classList.add('option-btn', 'w-full', 'p-4', 'border-2', 'border-gray-300', 'rounded-lg', 'text-left', 'hover:bg-gray-100', 'hover:border-blue-400', 'transition-colors', 'duration-200');
                
                // Create rationale div
                const rationaleDiv = document.createElement('div');
                rationaleDiv.textContent = option.rationale;
                rationaleDiv.classList.add('rationale');
                if (option.isCorrect) {
                    rationaleDiv.classList.add('rationale-correct');
                } else {
                    rationaleDiv.classList.add('rationale-incorrect');
                }
                button.appendChild(rationaleDiv);

                button.addEventListener('click', () => selectAnswer(button, option.isCorrect));
                optionsContainer.appendChild(button);
            });

            // Typeset the math content
            if (window.MathJax) {
                MathJax.typesetPromise([quizContainer])
                    .catch((err) => console.log('MathJax typesetting error: ', err));
            }
        }

        /**
         * Resets the options container for the next question.
         */
        function resetState() {
            nextBtn.classList.add('hidden');
            while (optionsContainer.firstChild) {
                optionsContainer.removeChild(optionsContainer.firstChild);
            }
        }

        /**
         * Handles the user's answer selection.
         */
        function selectAnswer(selectedButton, isCorrect) {
            if (isCorrect) {
                score++;
                selectedButton.classList.add('selected-correct');
            } else {
                selectedButton.classList.add('selected-incorrect');
            }

            // Disable all buttons and show rationale
            Array.from(optionsContainer.children).forEach(button => {
                button.disabled = true;
                const rationale = button.querySelector('.rationale');
                rationale.style.display = 'block';

                // Also show the correct answer if a wrong one was selected
                const optionText = button.dataset.originalText; // Get text from data-attribute
                const option = activeQuizData[currentQuestionIndex].options.find(opt => opt.text === optionText);
                if (option && !isCorrect && option.isCorrect) {
                    button.classList.add('selected-correct');
                }
            });

            // Show the next button
            nextBtn.classList.remove('hidden');
        }

        /**
         * Shows the final results.
         */
        function showResults() {
            quizContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');
            scoreText.textContent = `Your score: ${score} / ${activeQuizData.length}`;
            if (window.MathJax) {
                MathJax.typesetPromise([resultContainer])
                    .catch((err) => console.log('MathJax typesetting error: ', err));
            }
        }

        /**
         * Event handler for the next button.
         */
        function handleNextButton() {
            currentQuestionIndex++;
            if (currentQuestionIndex < activeQuizData.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        // --- Event Listeners ---
        nextBtn.addEventListener('click', handleNextButton);
        restartBtn.addEventListener('click', startQuiz);

        // --- Start the Quiz on Page Load ---
        document.addEventListener('DOMContentLoaded', startQuiz);

    </script>
</body>
</html>




